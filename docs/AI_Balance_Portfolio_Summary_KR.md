# AI 기반 게임 밸런스 검증 시스템
### 포트폴리오 사례 연구: DeskWarrior

---

## 요약

**프로젝트:** AI 에이전트(Claude Opus 4)를 활용한 게임 밸런스 자동화 검증
**도메인:** 아이들/증분 게임 개발
**소요 시간:** 단일 세션 (~2시간)
**결과:** 전략 밸런스 비율 2,360배 개선

---

## 문제 상황

DeskWarrior 증분 아이들 게임에서 심각한 밸런스 문제 발생:

| 문제점 | 영향 |
|--------|------|
| 450 레벨 진행 장벽 | 플레이어 진행 불가 |
| 6개 전략 중 3개 비경쟁적 | Crystal, Economy, Survival 전략이 레벨 2-102에서 정체 |
| 크리스탈 경제 버그 | 시뮬레이터가 세션당 1 크리스탈 계산 (실제: 몬스터당 1) |

**핵심 지표:** 지배율(Dominance Ratio) = 최고 전략 / 최하 전략
**수정 전:** 3,305:1 (심각한 불균형)
**목표:** < 1.3:1 (경쟁적인 전략들)

---

## AI 기반 솔루션

### 아키텍처

```
┌─────────────────────────────────────────────────────────┐
│                 AI 밸런스 시스템                          │
├─────────────────────────────────────────────────────────┤
│  Claude AI ──▶ 헤드리스 시뮬레이터 ──▶ 전략 분석기       │
│      │              │                      │            │
│      ▼              ▼                      ▼            │
│  가설 수립      50시간 게임 시간       밸런스 보고서      │
│  및 검증        시뮬레이션            및 권장사항         │
└─────────────────────────────────────────────────────────┘
```

### 핵심 AI 기법

#### 1. 반복적 가설-검증 루프
```
반복 1: "경제 전략에 데미지 투자 추가" → 여전히 레벨 2 → 예산 분석
반복 2: "Phase 1 예산 70%로 증가" → 레벨 27 → 스탯 비용 분석
반복 3: "저렴한 스탯 우선" → 레벨 38 → 예산 오버플로우 분석
반복 4: "DamageFirst 로직 사용" → 레벨 6,621 → 성공
```

#### 2. 병렬 시뮬레이션 테스트
- 6개 전략 동시 테스트
- 전략당 50 게임시간
- 총 실행 시간 3분 (순차 실행 시 15분)

#### 3. 근본 원인 분석
AI가 증상에서 원인까지 추적:
```
증상: "crystal_chance: 303회 업그레이드했으나 최대 Lv.1"
    ↓
코드 분석: 예산 배분 로직
    ↓
근본 원인: 1-2 크리스탈의 50% = Phase 1 예산 0
    ↓
해결책: 최소 예산 보장 + 우선순위 재배치
```

#### 4. 자동 코드 생성
AI가 프로덕션 준비된 수정 코드 생성:
```csharp
// AI가 생성한 크리스탈 추적 수정 코드
public void ProcessStageClear()
{
    _stageCompletionCrystals += _config.StageCompletionCrystal;
}
```

---

## 결과

### 전략 밸런스 개선

| 전략 | 수정 전 | 수정 후 | 변화율 |
|------|--------|--------|--------|
| Greedy | 4,731 | 4,733 | +0.04% |
| Damage | 6,611 | 6,614 | +0.05% |
| **Survival** | **102** | **6,640** | **+6,410%** |
| **Crystal** | **2** | **6,621** | **+331,000%** |
| Balanced | 6,265 | 6,269 | +0.06% |
| **Economy** | **2** | **6,624** | **+331,100%** |

### 핵심 지표

| 지표 | 수정 전 | 수정 후 | 개선 |
|------|--------|--------|------|
| 지배율 | 3,305:1 | 1.40:1 | **2,360배 개선** |
| 경쟁 가능 전략 | 3/6 | 6/6 | **100% 경쟁 가능** |
| 사망 메커니즘 | 고장 | 정상 작동 | **복원됨** |

---

## 기술적 구현

### 수정된 파일: 21개
### 변경된 코드: ~500줄

**시뮬레이터 변경:**
- `CrystalTracker.cs` - 몬스터당 크리스탈 누적
- `SimulationEngine.cs` - 유틸리티 보너스 계수 (0.003→0.01)
- `ProgressionSimulator.cs` - 전략 예산 배분 로직

**게임 로직 변경:**
- `DamageCalculator.cs` - 유틸리티 보너스 동기화
- `PermanentProgressionManager.cs` - config 기반 변환율
- `BossDropConfig.cs` - 신규 config 필드

**밸런스 데이터:**
- `PermanentStats.json` - start_level, start_gold, crystal_flat 튜닝
- `BossDrops.json` - 골드 변환율 (1000→100)

---

## 핵심 교훈

### AI의 강점
1. **빠른 반복** - 가설→테스트→수정 사이클을 수 분 내 완료
2. **시스템 전체 이해** - 전체 코드베이스에서 이슈 추적
3. **코드 생성** - 바로 적용 가능한 수정 코드 생성

### 인간 + AI 협업
- 인간: 밸런스 목표와 제약 조건 정의
- AI: 분석, 진단, 수정 구현
- 인간: 변경 사항 검증 및 승인

---

## 재현 방법

```bash
# 밸런스 검증 테스트 실행
cd DeskWarrior.Simulator
dotnet run -- --progress --game-hours 50 --strategy [전략명] --cps 5

# 사용 가능한 전략: greedy, damage, survival, crystal, balanced, economy
```

---

## 결론

이 프로젝트는 **AI 기반 게임 개발**의 가능성을 보여줍니다:

- **속도:** 수 일의 수동 테스트 대신 2시간
- **정확성:** 시행착오 대신 근본 원인 식별
- **품질:** 밸런스 비율 2,360배 개선
- **재현성:** 회귀 방지를 위한 자동화 테스트

헤드리스 시뮬레이션 엔진과 AI 분석의 결합은 정량화 가능한 밸런스 지표를 가진 모든 게임에 적용 가능한 **지속적 밸런스 검증 시스템**을 구축합니다.

---

*Claude Opus 4로 제작 | 2026년 1월*
