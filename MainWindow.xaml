<Window x:Class="DeskWarrior.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="clr-namespace:DeskWarrior.ViewModels"
        xmlns:controls="clr-namespace:DeskWarrior.Controls"
        Title="DeskWarrior"
        Width="280"
        Height="285"
        AllowsTransparency="True"
        Background="Transparent"
        WindowStyle="None"
        Topmost="True"
        ShowInTaskbar="False"
        ResizeMode="NoResize"
        WindowStartupLocation="Manual"
        Left="100"
        Top="100"
        MouseLeftButtonDown="Window_MouseLeftButtonDown"
        PreviewKeyDown="Window_PreviewKeyDown"
        Focusable="True">

    <Grid>
        <!-- ë°°ê²½ ì´ë¯¸ì§€ (ìœˆë„ìš° ì „ì²´, ê°€ìž¥ ë’¤) -->
        <Image x:Name="BackgroundImage"
               Source="pack://application:,,,/Assets/Images/bg_floor_sparse_pilot_v2.png"
               Stretch="UniformToFill"
               Margin="3"
               Panel.ZIndex="0"
               IsHitTestVisible="False"/>


        <!-- ë©”ì¸ ì»¨í…ì¸  -->
        <Border x:Name="MainBackgroundBorder" Background="#CC2A2A2A" CornerRadius="10" Margin="3" Panel.ZIndex="1">
            <Grid Margin="8">
                <Grid.RowDefinitions>
                    <RowDefinition Height="22"/>
                    <RowDefinition Height="32"/>
                    <RowDefinition Height="*" MinHeight="50"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <!-- Row 0: ìž¬í™” + íƒ€ì´ë¨¸ + X ë²„íŠ¼ -->
                <Border x:Name="GoldInfoBarTop" Grid.Row="0"
                        Background="#44000000" CornerRadius="5" Padding="4,2"
                        BorderBrush="#00CED1" BorderThickness="1"
                        VerticalAlignment="Stretch"
                        Margin="0"
                        Cursor="Hand"
                        MouseLeftButtonDown="InfoBar_MouseLeftButtonDown"
                        ToolTip="í´ë¦­í•˜ì—¬ ëª¨ë“œ ì „í™˜ (F1)">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>

                        <!-- ê³¨ë“œ -->
                        <StackPanel Grid.Column="0" Orientation="Horizontal" VerticalAlignment="Center">
                            <Image Source="pack://application:,,,/Assets/Images/UI/gold.png" Width="16" Height="16" VerticalAlignment="Center" Margin="0,2,3,0"/>
                            <TextBlock x:Name="GoldTextTop" Text="{Binding GoldText}" FontSize="12" Foreground="#FFD700" FontWeight="Bold" VerticalAlignment="Center" MinWidth="32"/>
                        </StackPanel>

                        <!-- í¬ë¦¬ìŠ¤í„¸ -->
                        <StackPanel Grid.Column="1" Orientation="Horizontal" VerticalAlignment="Center" Margin="8,0,0,0">
                            <Image Source="pack://application:,,,/Assets/Images/UI/crystal.png" Width="16" Height="16" VerticalAlignment="Center" Margin="0,2,3,0">
                                <Image.Effect>
                                    <DropShadowEffect Color="#00CED1" ShadowDepth="0" BlurRadius="4" Opacity="0.5"/>
                                </Image.Effect>
                            </Image>
                            <TextBlock x:Name="CrystalTextTop" Text="0" FontSize="12" Foreground="#00CED1" FontWeight="Bold" VerticalAlignment="Center" MinWidth="24">
                                <TextBlock.Effect>
                                    <DropShadowEffect Color="#00CED1" ShadowDepth="0" BlurRadius="4" Opacity="0.5"/>
                                </TextBlock.Effect>
                            </TextBlock>
                        </StackPanel>

                        <!-- íƒ€ì´ë¨¸ -->
                        <StackPanel Grid.Column="2" Orientation="Horizontal" VerticalAlignment="Center" Margin="8,0,0,0">
                            <Image Source="pack://application:,,,/Assets/Images/UI/Icon_Timer.png" Width="14" Height="14" VerticalAlignment="Center" Margin="0,2,3,0"/>
                            <TextBlock x:Name="TimerText" Text="{Binding TimerText}" FontSize="12" FontWeight="Bold" Foreground="#87CEEB" VerticalAlignment="Center" MinWidth="20" TextAlignment="Left"/>
                        </StackPanel>

                        <!-- ìš°ì¸¡: X ë²„íŠ¼ -->
                        <Border x:Name="ExitButtonBorderInline" Grid.Column="4"
                                Background="#662222"
                                BorderBrush="#FF4444" BorderThickness="1"
                                CornerRadius="3"
                                Width="18" Height="18"
                                Cursor="Hand"
                                Visibility="Visible"
                                ToolTip="ì¢…ë£Œ"
                                MouseLeftButtonDown="ExitButton_MouseLeftButtonDown">
                            <TextBlock Text="âœ•" FontSize="10" Foreground="#FF8888"
                                       HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                    </Grid>
                </Border>

                <!-- Row 1: ì  ì •ë³´ -->
                <Border x:Name="EnemyInfoBorder" Grid.Row="1"
                        Background="#88000000" CornerRadius="4" Padding="6,4"
                        VerticalAlignment="Stretch" Margin="0,2,0,0"
                        Panel.ZIndex="1">
                    <Grid VerticalAlignment="Center">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <StackPanel Grid.Column="0" Orientation="Horizontal" VerticalAlignment="Center">
                            <TextBlock x:Name="LevelText" Text="{Binding LevelText}" FontSize="12" Foreground="White" FontWeight="Bold"/>
                            <TextBlock Text="{Binding MonsterName}" FontSize="12" Foreground="#88ff88" Margin="5,0,0,0" FontWeight="SemiBold"/>
                            <TextBlock x:Name="MaxLevelText" Text="{Binding MaxLevelText}" FontSize="8" Foreground="#AAA" VerticalAlignment="Bottom" Margin="4,0,0,0" Visibility="Collapsed"/>
                        </StackPanel>

                        <!-- HP ë°” (ë™ì  í¬ê¸°) -->
                        <Grid x:Name="HpBarContainer" Grid.Column="1" Height="8" Margin="8,0,8,0" VerticalAlignment="Center">
                            <Border Background="#333" CornerRadius="3"/>
                            <Border x:Name="HpBar" Background="#00FF00" CornerRadius="3" HorizontalAlignment="Left" Width="0"/>
                        </Grid>
                        <TextBlock x:Name="HpText" Text="{Binding HpText}" FontSize="9" Foreground="#AAA" HorizontalAlignment="Left" Visibility="Collapsed"/>
                    </Grid>
                </Border>

                <!-- Row 2: ë°°í‹€ í•„ë“œ (ëª¬ìŠ¤í„°, ížˆì–´ë¡œ) -->
                <Grid Grid.Row="2" Panel.ZIndex="1">
                    <!-- ì  ëª¬ìŠ¤í„° (ìš°ì¸¡ ìƒë‹¨) -->
                    <Image x:Name="MonsterImage"
                           Source="pack://application:,,,/Assets/Images/monster.png"
                           Width="80" Height="80"
                           Stretch="Uniform"
                           HorizontalAlignment="Right"
                           VerticalAlignment="Top"
                           Margin="0,-10,10,0"
                           RenderTransformOrigin="0.5,0.5"
                           Panel.ZIndex="2"
                           MouseLeftButtonDown="GameElement_MouseLeftButtonDown">
                        <Image.RenderTransform>
                            <TranslateTransform x:Name="MonsterShakeTransform"/>
                        </Image.RenderTransform>
                    </Image>

                    <!-- ë°ë¯¸ì§€ íŒì—… ì˜ì—­ -->
                    <Canvas x:Name="DamagePopupCanvas"
                            HorizontalAlignment="Right"
                            VerticalAlignment="Top"
                            Width="90" Height="90"
                            Margin="0,5,5,0"
                            Panel.ZIndex="10"
                            IsHitTestVisible="False"/>

                    <!-- í”Œë ˆì´ì–´ ížˆì–´ë¡œ (ì¢Œì¸¡ í•˜ë‹¨) -->
                    <Image x:Name="HeroImage"
                           Source="pack://application:,,,/Assets/Images/hero.png"
                           Width="90" Height="90"
                           Stretch="Uniform"
                           HorizontalAlignment="Left"
                           VerticalAlignment="Bottom"
                           Margin="10,0,0,0"
                           Panel.ZIndex="3"
                           MouseLeftButtonDown="GameElement_MouseLeftButtonDown"/>
                </Grid>

                <!-- Row 3: ì—…ê·¸ë ˆì´ë“œ ë²„íŠ¼ íŒ¨ë„ -->
                <Border x:Name="UpgradePanel" Grid.Row="3"
                        Background="#88000000" CornerRadius="4"
                        Margin="0,2,0,0" Padding="2"
                        Visibility="Visible"
                        Panel.ZIndex="20"
                        PreviewMouseLeftButtonDown="UpgradePanel_PreviewMouseLeftButtonDown">
                    <UniformGrid Columns="2" Rows="1">
                        <!-- í‚¤ë³´ë“œ ê³µê²©ë ¥ -->
                        <RepeatButton x:Name="UpgradeKeyboardBtn"
                                Click="UpgradeKeyboard_Click"
                                Style="{StaticResource StatUpgradeRepeatButton}"
                                Margin="1" Height="24"
                                Delay="400" Interval="80"
                                ToolTip="í‚¤ë³´ë“œ ê³µê²©ë ¥ ì¦ê°€">
                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" VerticalAlignment="Center">
                                <TextBlock x:Name="KeyboardLevelText" Text="Lv.0" FontSize="10" Foreground="#AAAAAA" FontWeight="Bold" VerticalAlignment="Center" Margin="0,0,3,0"/>
                                <TextBlock x:Name="KeyboardIconText" Text="âŒ¨" FontSize="11" VerticalAlignment="Center" Margin="0,0,3,0" Foreground="#00CED1" FontWeight="Bold"/>
                                <TextBlock x:Name="KeyboardPowerText" Text="{Binding KeyboardPowerText}" FontSize="10" Foreground="#00CED1" FontWeight="Bold" VerticalAlignment="Center"/>
                            </StackPanel>
                        </RepeatButton>

                        <!-- ë§ˆìš°ìŠ¤ ê³µê²©ë ¥ -->
                        <RepeatButton x:Name="UpgradeMouseBtn"
                                Click="UpgradeMouse_Click"
                                Style="{StaticResource StatUpgradeRepeatButton}"
                                Margin="1" Height="24"
                                Delay="400" Interval="80"
                                ToolTip="ë§ˆìš°ìŠ¤ ê³µê²©ë ¥ ì¦ê°€">
                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" VerticalAlignment="Center">
                                <TextBlock x:Name="MouseLevelText" Text="Lv.0" FontSize="10" Foreground="#AAAAAA" FontWeight="Bold" VerticalAlignment="Center" Margin="0,0,3,0"/>
                                <TextBlock x:Name="MouseIconText" Text="ðŸ–°" FontSize="11" VerticalAlignment="Center" Margin="0,0,3,0" Foreground="#E8D03F" FontWeight="Bold"/>
                                <TextBlock x:Name="MousePowerText" Text="{Binding MousePowerText}" FontSize="10" Foreground="#E8D03F" FontWeight="Bold" VerticalAlignment="Center"/>
                            </StackPanel>
                        </RepeatButton>
                    </UniformGrid>
                </Border>

                <!-- Row 4: ìœ í‹¸ë¦¬í‹° ë²„íŠ¼ íŒ¨ë„ (í†µê³„, ìƒì , ì„¤ì •) -->
                <Border x:Name="UtilityPanel" Grid.Row="4"
                        Background="#88000000" CornerRadius="4"
                        Margin="0,2,0,0" Padding="2"
                        Visibility="Visible"
                        Panel.ZIndex="20">
                    <UniformGrid x:Name="UtilityButtonsGrid" Columns="3" Rows="1">
                        <!-- í†µê³„ ë²„íŠ¼ -->
                        <Button x:Name="StatsBtn"
                                Click="StatsButton_Click"
                                Style="{StaticResource SettingsButton}"
                                Margin="1" Height="24">
                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                <TextBlock Text="ðŸ“Š" FontSize="12" VerticalAlignment="Center" Margin="0,0,3,0"/>
                                <TextBlock x:Name="StatsBtnText" FontSize="10" VerticalAlignment="Center" Foreground="White"/>
                            </StackPanel>
                        </Button>

                        <!-- ì˜êµ¬ ìƒì  ë²„íŠ¼ -->
                        <Button x:Name="PermanentShopBtn"
                                Click="PermanentShopButton_Click"
                                Style="{StaticResource SettingsButton}"
                                Margin="1" Height="24">
                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                <Image Source="pack://application:,,,/Assets/Images/UI/crystal.png" Width="12" Height="12" VerticalAlignment="Center" Margin="0,0,3,0"/>
                                <TextBlock x:Name="ShopBtnText" FontSize="10" VerticalAlignment="Center" Foreground="White"/>
                            </StackPanel>
                        </Button>

                        <!-- ì„¤ì • ë²„íŠ¼ -->
                        <Button x:Name="SettingsBtn"
                                Click="SettingsButton_Click"
                                Style="{StaticResource SettingsButton}"
                                Margin="1" Height="24">
                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                <TextBlock Text="âš™ï¸" FontSize="12" VerticalAlignment="Center" Margin="0,0,3,0"/>
                                <TextBlock x:Name="SettingsBtnText" FontSize="10" VerticalAlignment="Center" Foreground="White"/>
                            </StackPanel>
                        </Button>
                    </UniformGrid>
                </Border>
            </Grid>
        </Border>

        <!-- ë””ë²„ê·¸ í‘œì‹œ -->
        <TextBlock x:Name="DebugText" Text="" Foreground="#888" FontSize="8"
                   HorizontalAlignment="Center" VerticalAlignment="Bottom" Margin="0,0,0,5"
                   Visibility="Collapsed"/>

        <!-- ìž…ë ¥ íšŸìˆ˜ (ìˆ¨ê¹€, í†µê³„ìš©) -->
        <TextBlock x:Name="InputCountText" Text="0" Visibility="Collapsed"/>

        <!-- Game Over Overlay (UserControl) -->
        <controls:GameOverOverlay x:Name="GameOverOverlayControl"
                                   Visibility="Collapsed"
                                   Panel.ZIndex="200"
                                   MouseLeftButtonDown="Window_MouseLeftButtonDown"/>
    </Grid>
</Window>
